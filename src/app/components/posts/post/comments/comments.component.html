@for (comment of comments; track comment.id) {
  <div class="container">
    <p-panel [toggleable]="true">
      <ng-template pTemplate="header">
        <div class="flex flex-column gap-2">
          @if (comment.user_email === user_uid) {
            <i (click)="edit(comment.body)" class="pi pi-pen-to-square cursor" style=""></i>
          }

          <div>
            <p-avatar
              [label]="comment.user_email.charAt(0).toUpperCase()"
              size="large"
              shape="circle"
              [style]="avatar_color()"
            />
            <span class="font-bold"> {{ comment.user_email.slice(0, 12) }}...</span>
          </div>
        </div>
      </ng-template>

      <div class="w-full">
        @if (!show_edit()) {
          <p class="m-0">{{ comment.body }}</p>
        } @else {
          <div class="w-full">
            <p-panel header="Edit your comment..." [toggleable]="true">
              <form [formGroup]="formData" (ngSubmit)="onSubmit(comment.id, comment.post_id)">
                <p-floatLabel>
                  <textarea
                    id="float-input2"
                    rows="5"
                    [style]="{ width: '100%' }"
                    pInputTextarea
                    formControlName="body"
                  >
                  </textarea>
                  <label for="float-input2">Post a comment</label>
                </p-floatLabel>
                <p-button type="submit" label="Update" severity="danger" />
              </form>
            </p-panel>
          </div>
        }

        <div class="flex flex-wrap align-items-center justify-content-between gap-3">
          <span class="p-text-secondary"> {{ comment.created_at | timeAgo }} </span>
        </div>
      </div>

      <ng-template pTemplate="footer">
        <p>Reply({{ comment.replies.length }})</p>
        @for (reply of comment.replies; track reply.id) {
          <p-panel [toggleable]="true">
            <ng-template pTemplate="header">
              <div class="flex align-items-center gap-2">
                <div>
                  <p-avatar
                    [label]="reply.user_email.charAt(0).toUpperCase()"
                    size="large"
                    shape="circle"
                    [style]="avatar_color()"
                  />
                  <span class="font-bold"> {{ reply.user_email.slice(0, 12) }}...</span>
                </div>
              </div>
            </ng-template>

            <div>
              <p class="m-0">{{ reply.body }}</p>
              <div class="flex flex-wrap align-items-center justify-content-between gap-3">
                <span class="p-text-secondary"> {{ reply.created_at | timeAgo }} </span>
              </div>
            </div>
          </p-panel>
        }
      </ng-template>
    </p-panel>
  </div>
}
